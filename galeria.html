<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Galería - Ecosistemas terrestres en Cuba</title>
    <link rel="stylesheet" href="./css/thesis-style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .gallery-item {
        position: relative;
        overflow: hidden;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        background-color: #f9f9f9;
      }

      .gallery-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }

      .gallery-item img {
        width: 100%;
        height: 250px;
        object-fit: cover;
        display: block;
        transition: transform 0.5s ease;
      }

      .gallery-item:hover img {
        transform: scale(1.05);
      }

      /* Eliminamos completamente los estilos de caption */
      .gallery-caption {
        display: none !important;
      }

      .content-box {
        background-color: rgba(26, 47, 56, 0.97);
        border-radius: 10px;
        padding: 30px;
        margin: 20px auto;
        max-width: 1200px;
      }

      h1 {
        text-align: center;
        margin-bottom: 30px;
        color: #2c3e50;
      }

      .lightbox {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.9);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .lightbox-content {
        max-width: 90%;
        max-height: 90%;
      }

      .lightbox-content img {
        max-width: 100%;
        max-height: 90vh;
        display: block;
        margin: 0 auto;
        border-radius: 5px;
      }

      .lightbox-caption {
        color: white;
        text-align: center;
        padding: 10px;
        font-size: 18px;
      }

      .close-lightbox {
        position: absolute;
        top: 20px;
        right: 20px;
        color: white;
        font-size: 30px;
        cursor: pointer;
      }

      .lightbox-nav {
        position: absolute;
        top: 50%;
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 20px;
        box-sizing: border-box;
      }

      .lightbox-nav button {
        background: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 24px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .lightbox-nav button:hover {
        background: rgba(0, 0, 0, 0.8);
      }

      #particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
      }

      .particle {
        position: absolute;
        background-color: rgba(46, 204, 113, 0.3);
        border-radius: 50%;
        animation: particleFloat linear infinite;
      }

      @keyframes particleFloat {
        0% {
          transform: translateY(0) translateX(0);
        }
        25% {
          transform: translateY(-20px) translateX(10px);
        }
        50% {
          transform: translateY(0) translateX(20px);
        }
        75% {
          transform: translateY(20px) translateX(10px);
        }
        100% {
          transform: translateY(0) translateX(0);
        }
      }

      .loading {
        text-align: center;
        padding: 20px;
        font-size: 18px;
        color: #666;
      }
    </style>
  </head>
  <body>
    <!-- Particle container -->
    <div id="particles"></div>

    <nav class="navbar">
      <div class="nav-container">
        <a href="index.html" class="nav-logo">Ecosistemas terrestres en Cuba</a>
        <button class="nav-toggle" id="navToggle">
          <i class="fas fa-bars"></i>
        </button>
        <ul class="nav-menu" id="navMenu">
          <li><a href="index.html">Inicio</a></li>
          <li><a href="galeria.html" class="active">Galería</a></li>
          <li><a href="audiovisuales.html">Audiovisuales</a></li>
          <li><a href="contacto.html">Contacto</a></li>
          <li><a href="admin.html">Admin</a></li>
        </ul>
      </div>
    </nav>

    <div class="container">
      <div class="content-box">
        <h1>Galería de Imágenes - Ecosistemas terrestres en Cuba</h1>

        <div class="loading" id="loading">Cargando imágenes...</div>
        <div class="gallery" id="gallery">
          <!-- Las imágenes se cargarán dinámicamente aquí -->
        </div>
      </div>
    </div>

    <!-- Lightbox para ver imágenes ampliadas -->
    <div class="lightbox" id="lightbox">
      <span class="close-lightbox" id="closeLightbox">&times;</span>
      <div class="lightbox-content">
        <img id="lightboxImage" src="" alt="Imagen ampliada" />
        <div class="lightbox-caption" id="lightboxCaption"></div>
      </div>
      <div class="lightbox-nav">
        <button id="prevImage"><i class="fas fa-chevron-left"></i></button>
        <button id="nextImage"><i class="fas fa-chevron-right"></i></button>
      </div>
    </div>

    <script>
      // Navegación
      const navToggle = document.getElementById("navToggle");
      const navMenu = document.getElementById("navMenu");

      navToggle.addEventListener("click", () => {
        navMenu.classList.toggle("active");
        // Cambiar el ícono cuando se abre/cierra el menú
        const icon = navToggle.querySelector("i");
        icon.classList.toggle("fa-bars");
        icon.classList.toggle("fa-times");
      });

      // Cerrar el menú al hacer clic en un enlace
      document.querySelectorAll(".nav-menu a").forEach((link) => {
        link.addEventListener("click", () => {
          navMenu.classList.remove("active");
          const icon = navToggle.querySelector("i");
          icon.classList.add("fa-bars");
          icon.classList.remove("fa-times");
        });
      });

      // Sistema de partículas
      document.addEventListener("DOMContentLoaded", function () {
        createParticles();
        loadAllImages();
      });

      function createParticles() {
        const particlesContainer = document.getElementById("particles");
        const numberOfParticles = 50;

        for (let i = 0; i < numberOfParticles; i++) {
          const particle = document.createElement("div");
          particle.className = "particle";

          // Propiedades aleatorias
          const size = Math.random() * 5 + 2;
          const posX = Math.random() * 100;
          const posY = Math.random() * 100;
          const animationDuration = Math.random() * 20 + 10;
          const animationDelay = Math.random() * 5;

          particle.style.width = size + "px";
          particle.style.height = size + "px";
          particle.style.left = posX + "%";
          particle.style.top = posY + "%";
          particle.style.animationDuration = animationDuration + "s";
          particle.style.animationDelay = animationDelay + "s";

          particlesContainer.appendChild(particle);
        }
      }

      // Función para cargar todas las imágenes disponibles
      function loadAllImages() {
        const gallery = document.getElementById("gallery");
        const loading = document.getElementById("loading");

        // Limpiar el mensaje de carga
        loading.style.display = "none";

        // Limpiar la galería
        gallery.innerHTML = "";

        // Lista de todas las imágenes en la carpeta imgs con el formato correcto
        const imageFiles = [
          { path: "./imgs/IMG-20250506-WA0819.jpg", name: "Ecosistema 1" },
          { path: "./imgs/IMG-20250506-WA0820.jpg", name: "Ecosistema 2" },
          { path: "./imgs/IMG-20250506-WA0821.jpg", name: "Ecosistema 3" },
          { path: "./imgs/IMG-20250506-WA0822.jpg", name: "Ecosistema 4" },
          { path: "./imgs/IMG-20250506-WA0823.jpg", name: "Ecosistema 5" },
          { path: "./imgs/IMG-20250506-WA0824.jpg", name: "Ecosistema 6" },
          { path: "./imgs/IMG-20250506-WA0825.jpg", name: "Ecosistema 7" },
          { path: "./imgs/IMG-20250506-WA0826.jpg", name: "Ecosistema 8" },
          { path: "./imgs/IMG-20250506-WA0827.jpg", name: "Ecosistema 9" },
          { path: "./imgs/IMG-20250506-WA0828.jpg", name: "Ecosistema 10" },
          { path: "./imgs/IMG-20250506-WA0829.jpg", name: "Ecosistema 11" },
          { path: "./imgs/IMG-20250506-WA0830.jpg", name: "Ecosistema 12" },
          { path: "./imgs/IMG-20250506-WA0831.jpg", name: "Ecosistema 13" },
          { path: "./imgs/IMG-20250506-WA0832.jpg", name: "Ecosistema 14" },
          { path: "./imgs/IMG-20250506-WA0833.jpg", name: "Ecosistema 15" },
          { path: "./imgs/IMG-20250506-WA0834.jpg", name: "Ecosistema 16" },
          { path: "./imgs/IMG-20250506-WA0835.jpg", name: "Ecosistema 17" },
          { path: "./imgs/IMG-20250506-WA0836.jpg", name: "Ecosistema 18" },
          { path: "./imgs/IMG-20250506-WA0837.jpg", name: "Ecosistema 19" },
          { path: "./imgs/IMG-20250506-WA0838.jpg", name: "Ecosistema 20" },
          { path: "./imgs/IMG-20250506-WA0839.jpg", name: "Ecosistema 21" },
          { path: "./imgs/IMG-20250506-WA0840.jpg", name: "Ecosistema 22" },
          { path: "./imgs/IMG-20250506-WA0841.jpg", name: "Ecosistema 23" },
          { path: "./imgs/IMG-20250506-WA0842.jpg", name: "Ecosistema 24" },
          { path: "./imgs/IMG-20250506-WA0843.jpg", name: "Ecosistema 25" },
          { path: "./imgs/IMG-20250506-WA0844.jpg", name: "Ecosistema 26" },
          { path: "./imgs/IMG-20250506-WA0845.jpg", name: "Ecosistema 27" },
          { path: "./imgs/IMG-20250506-WA0846.jpg", name: "Ecosistema 28" },
          { path: "./imgs/IMG-20250506-WA0847.jpg", name: "Ecosistema 29" },
          { path: "./imgs/IMG-20250506-WA0848.jpg", name: "Ecosistema 30" },
          { path: "./imgs/IMG-20250506-WA0849.jpg", name: "Ecosistema 31" },
          { path: "./imgs/IMG-20250506-WA0850.jpg", name: "Ecosistema 32" },
          { path: "./imgs/IMG-20250506-WA0851.jpg", name: "Ecosistema 33" },
          { path: "./imgs/IMG-20250506-WA0852.jpg", name: "Ecosistema 34" },
          { path: "./imgs/IMG-20250506-WA0853.jpg", name: "Ecosistema 35" },
          { path: "./imgs/IMG-20250506-WA0854.jpg", name: "Ecosistema 36" },
          { path: "./imgs/IMG-20250506-WA0855.jpg", name: "Ecosistema 37" },
          { path: "./imgs/IMG-20250506-WA0856.jpg", name: "Ecosistema 38" },
        ];

        // Contador para verificar cuántas imágenes se cargaron correctamente
        let loadedImages = 0;
        let failedImages = 0;
        let totalImages = imageFiles.length;

        // Crear elementos para cada imagen
        imageFiles.forEach((image, index) => {
          const item = document.createElement("div");
          item.className = "gallery-item";

          const img = document.createElement("img");
          img.src = image.path;
          img.alt = image.name;
          img.dataset.index = index;

          // Manejar carga exitosa de imagen
          img.onload = function () {
            loadedImages++;
            if (loadedImages + failedImages === totalImages) {
              console.log(
                `Imágenes cargadas: ${loadedImages}, Fallidas: ${failedImages}`
              );
            }
          };

          // Manejar errores de carga de imagen
          img.onerror = function () {
            console.log("Error al cargar: " + image.path);
            failedImages++;

            // Crear un canvas como reemplazo para la imagen
            const canvas = document.createElement("canvas");
            canvas.width = 300;
            canvas.height = 250;
            const ctx = canvas.getContext("2d");

            // Dibujar un fondo gris con texto
            ctx.fillStyle = "#e0e0e0";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#666666";
            ctx.font = "16px Arial";
            ctx.textAlign = "center";
            ctx.fillText(
              "Imagen no disponible",
              canvas.width / 2,
              canvas.height / 2
            );

            // Usar el canvas como imagen
            img.src = canvas.toDataURL();

            if (loadedImages + failedImages === totalImages) {
              console.log(
                `Imágenes cargadas: ${loadedImages}, Fallidas: ${failedImages}`
              );
            }
          };

          // No creamos el elemento caption

          item.appendChild(img);
          gallery.appendChild(item);

          // Abrir lightbox al hacer clic en la imagen
          img.addEventListener("click", () => {
            const visibleImages = Array.from(
              document.querySelectorAll(".gallery-item img")
            ).map((img) => ({
              path: img.src,
              name: img.alt,
            }));

            // Encontrar el índice actual en las imágenes visibles
            const currentIndex = visibleImages.findIndex(
              (img) => img.path === image.path
            );
            openLightbox(currentIndex >= 0 ? currentIndex : 0, visibleImages);
          });
        });

        // Verificar si hay imágenes adicionales con otros patrones de nombre
        setTimeout(function () {
          if (loadedImages === 0) {
            // Si no se cargó ninguna imagen, intentar con otros patrones
            tryAlternativeImagePatterns();
          }
        }, 2000);
      }

      // Función para intentar patrones alternativos de nombres de archivo
      function tryAlternativeImagePatterns() {
        const gallery = document.getElementById("gallery");

        // Patrones alternativos a probar
        const patterns = [
          {
            prefix: "IMG-",
            year: "20250506",
            separator: "-WA",
            startNum: 819,
            endNum: 856,
          },
          {
            prefix: "IMG-",
            year: "20230506",
            separator: "-WA",
            startNum: 819,
            endNum: 856,
          },
        ];

        let imageCount = 0;

        patterns.forEach((pattern) => {
          for (let i = pattern.startNum; i <= pattern.endNum; i++) {
            const num = i.toString().padStart(4, "0");
            const filename = `${pattern.prefix}${pattern.year}${pattern.separator}${num}.jpg`;
            const path = `./imgs/${filename}`;

            const item = document.createElement("div");
            item.className = "gallery-item";

            const img = document.createElement("img");
            img.src = path;
            img.alt = `Imagen ${imageCount + 1}`;
            img.dataset.index = imageCount;

            img.onload = function () {
              gallery.appendChild(item);
              imageCount++;

              // Configurar evento de clic
              img.addEventListener("click", () => {
                const visibleImages = Array.from(
                  document.querySelectorAll(".gallery-item img")
                ).map((img) => ({
                  path: img.src,
                  name: img.alt,
                }));

                const currentIndex = visibleImages.findIndex(
                  (img) => img.path === path
                );
                openLightbox(
                  currentIndex >= 0 ? currentIndex : 0,
                  visibleImages
                );
              });
            };

            img.onerror = function () {
              // No hacer nada si la imagen no existe
              item.remove();
            };

            item.appendChild(img);
          }
        });
      }

      // Variables para el lightbox
      let currentImageIndex = 0;
      let galleryImages = [];

      // Abrir lightbox
      function openLightbox(index, images) {
        const lightbox = document.getElementById("lightbox");

        // Si no se proporcionan imágenes, recopilar del DOM
        if (!images) {
          galleryImages = Array.from(
            document.querySelectorAll(".gallery-item img")
          ).map((img) => ({
            path: img.src,
            name: img.alt,
          }));
        } else {
          galleryImages = images;
        }

        if (galleryImages.length === 0) return;

        currentImageIndex = Math.min(index, galleryImages.length - 1);
        updateLightboxImage();

        lightbox.style.display = "flex";
        document.body.style.overflow = "hidden"; // Prevenir scroll
      }

      // Actualizar imagen en el lightbox
      function updateLightboxImage() {
        const lightboxImage = document.getElementById("lightboxImage");
        const lightboxCaption = document.getElementById("lightboxCaption");

        lightboxImage.src = galleryImages[currentImageIndex].path;
        lightboxCaption.textContent = galleryImages[currentImageIndex].name;
      }

      // Cerrar lightbox
      document.getElementById("closeLightbox").addEventListener("click", () => {
        document.getElementById("lightbox").style.display = "none";
        document.body.style.overflow = "auto"; // Restaurar scroll
      });

      // Navegación del lightbox
      document.getElementById("prevImage").addEventListener("click", () => {
        currentImageIndex =
          (currentImageIndex - 1 + galleryImages.length) % galleryImages.length;
        updateLightboxImage();
      });

      document.getElementById("nextImage").addEventListener("click", () => {
        currentImageIndex = (currentImageIndex + 1) % galleryImages.length;
        updateLightboxImage();
      });

      // Cerrar lightbox con tecla Escape
      document.addEventListener("keydown", (e) => {
        if (
          e.key === "Escape" &&
          document.getElementById("lightbox").style.display === "flex"
        ) {
          document.getElementById("lightbox").style.display = "none";
          document.body.style.overflow = "auto";
        }
      });
    </script>
  </body>
</html>
<!-- Asumiendo que tienes una sección de galería como esta -->
<div class="gallery-container">
  <!-- Aquí irán las 38 imágenes en un bucle -->
  <div class="gallery-item">
    <img src="imgs/IMG-20250506-WA0819.jpg" alt="Imagen 1" />
  </div>
  <div class="gallery-item">
    <img src="imgs/IMG-20250506-WA0820.jpg" alt="Imagen 2" />
  </div>
  <!-- ... y así sucesivamente hasta la imagen 38 (WA0856) -->
  <div class="gallery-item">
    <img src="imgs/IMG-20250506-WA0856.jpg" alt="Imagen 38" />
  </div>
</div>
<!-- Add this meta tag to your HTML files to prevent caching -->
<meta
  http-equiv="Cache-Control"
  content="no-cache, no-store, must-revalidate"
/>
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
