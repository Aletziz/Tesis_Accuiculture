<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Galería - Ecosistemas terrestres en Cuba</title>
    <link rel="stylesheet" href="css/thesis-style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .gallery-item {
        overflow: hidden;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
        cursor: pointer;
      }

      .gallery-item:hover {
        transform: scale(1.03);
      }

      .gallery-item img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        display: block;
      }

      /* Estilos para el lightbox */
      .lightbox {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.9);
        z-index: 1000;
        padding: 20px;
        box-sizing: border-box;
      }

      .lightbox-content {
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .lightbox-image {
        max-width: 90%;
        max-height: 80%;
        object-fit: contain;
      }

      .lightbox-caption {
        color: white;
        margin-top: 15px;
        font-size: 18px;
      }

      .lightbox-close {
        position: absolute;
        top: 20px;
        right: 20px;
        color: white;
        font-size: 30px;
        cursor: pointer;
      }

      .lightbox-nav {
        position: absolute;
        top: 50%;
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 20px;
        box-sizing: border-box;
      }

      .lightbox-nav button {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 24px;
        padding: 10px 15px;
        cursor: pointer;
        border-radius: 5px;
      }

      .lightbox-nav button:hover {
        background: rgba(255, 255, 255, 0.3);
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <div class="nav-container">
        <a href="index.html" class="nav-logo">Ecosistemas terrestres en Cuba</a>
        <button id="navToggle" class="nav-toggle">
          <i class="fas fa-bars"></i>
        </button>
        <ul id="navMenu" class="nav-menu">
          <li><a href="index.html">Inicio</a></li>
          <li><a href="capitulo1.html">Capítulo 1</a></li>
          <li><a href="capitulo2.html">Capítulo 2</a></li>
          <li><a href="capitulo3.html">Capítulo 3</a></li>
          <li><a href="capitulo4.html">Capítulo 4</a></li>
          <li><a href="capitulo5.html">Capítulo 5</a></li>
          <li><a href="galeria.html" class="active">Galería</a></li>
        </ul>
      </div>
    </nav>

    <div class="container">
      <div class="content-box">
        <h1>Galería de Imágenes - Ecosistemas terrestres en Cuba</h1>

        <div id="gallery" class="gallery">
          <!-- Las imágenes se cargarán aquí mediante JavaScript -->
        </div>
      </div>
    </div>

    <!-- Lightbox para ver imágenes ampliadas -->
    <div id="lightbox" class="lightbox">
      <div class="lightbox-content">
        <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
        <img id="lightbox-image" class="lightbox-image" src="" alt="" />
        <div id="lightbox-caption" class="lightbox-caption"></div>
        <div class="lightbox-nav">
          <button onclick="changeImage(-1)">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button onclick="changeImage(1)">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>

    <script>
      // Navegación
      const navToggle = document.getElementById("navToggle");
      const navMenu = document.getElementById("navMenu");
      navToggle.addEventListener("click", () => {
        navMenu.classList.toggle("active");
      });

      // Variables para el lightbox
      let currentImageIndex = 0;
      let images = [];

      // Cargar imágenes
      document.addEventListener("DOMContentLoaded", function () {
        loadGalleryImages();
      });

      function loadGalleryImages() {
        const gallery = document.getElementById("gallery");
        gallery.innerHTML = ""; // Limpiar galería

        // Crear array con las rutas de las imágenes
        images = [];
        for (let i = 819; i <= 856; i++) {
          // Corregimos el formato del número para que coincida exactamente con tus archivos
          let imgNum = i;
          images.push({
            src: `imgs/IMG-20250506-WA${imgNum}.jpg`,
            alt: `Ecosistema terrestre ${i - 818}`,
          });
        }

        // Crear elementos para cada imagen
        images.forEach((image, index) => {
          const item = document.createElement("div");
          item.className = "gallery-item";

          const img = document.createElement("img");
          img.src = image.src;
          img.alt = image.alt;

          // Manejar errores de carga
          img.onerror = function () {
            this.onerror = null;
            console.log(`No se pudo cargar: ${image.src}`);
            // En lugar de usar una imagen de reemplazo, creamos un div con texto
            this.style.display = "none";
            const errorDiv = document.createElement("div");
            errorDiv.style.width = "100%";
            errorDiv.style.height = "200px";
            errorDiv.style.backgroundColor = "#f0f0f0";
            errorDiv.style.display = "flex";
            errorDiv.style.alignItems = "center";
            errorDiv.style.justifyContent = "center";
            errorDiv.textContent = "Imagen no disponible";
            item.appendChild(errorDiv);
          };

          // Abrir lightbox al hacer clic
          img.onclick = function () {
            openLightbox(index);
          };

          item.appendChild(img);
          gallery.appendChild(item);
        });

        // Agregar mensaje si no se cargaron imágenes
        if (gallery.children.length === 0) {
          const message = document.createElement("p");
          message.textContent =
            "No se pudieron cargar las imágenes. Por favor, verifica la conexión o inténtalo más tarde.";
          message.style.textAlign = "center";
          message.style.padding = "20px";
          gallery.appendChild(message);
        }
      }

      // Funciones del lightbox
      function openLightbox(index) {
        const lightbox = document.getElementById("lightbox");
        const lightboxImage = document.getElementById("lightbox-image");
        const lightboxCaption = document.getElementById("lightbox-caption");

        currentImageIndex = index;
        lightboxImage.src = images[index].src;
        lightboxCaption.textContent = images[index].alt;
        lightbox.style.display = "block";

        // Evitar scroll en el body
        document.body.style.overflow = "hidden";
      }

      function closeLightbox() {
        document.getElementById("lightbox").style.display = "none";
        document.body.style.overflow = "auto";
      }

      function changeImage(direction) {
        currentImageIndex += direction;

        // Navegación circular
        if (currentImageIndex >= images.length) {
          currentImageIndex = 0;
        } else if (currentImageIndex < 0) {
          currentImageIndex = images.length - 1;
        }

        const lightboxImage = document.getElementById("lightbox-image");
        const lightboxCaption = document.getElementById("lightbox-caption");

        lightboxImage.src = images[currentImageIndex].src;
        lightboxCaption.textContent = images[currentImageIndex].alt;
      }

      // Cerrar lightbox con Escape
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
          closeLightbox();
        }
      });

      // Añade esta función al final del script
      function checkImagesExist() {
        console.log("Verificando imágenes...");
        for (let i = 819; i <= 856; i++) {
          const img = new Image();
          img.src = `imgs/IMG-20250506-WA${i}.jpg`;
          img.onload = function () {
            console.log(`✅ Imagen encontrada: IMG-20250506-WA${i}.jpg`);
          };
          img.onerror = function () {
            console.log(`❌ Imagen NO encontrada: IMG-20250506-WA${i}.jpg`);
          };
        }
      }

      // Ejecutar verificación después de cargar la página
      setTimeout(checkImagesExist, 2000);
    </script>
  </body>
</html>
